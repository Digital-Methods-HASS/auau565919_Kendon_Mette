---
title: "Comparison of COVID-19 with the Spanish Flu 1918"
author: "Mette Emily Kendon"
date: "12/21/2020"
output: html_document
---

#Downloading packages

Packages used for the following project:

```{r}
library(tidyverse)
library(lubridate)
library(readxl)
library(writexl)
```


Link to packages:
- https://www.tidyverse.org
- https://lubridate.tidyverse.org
- https://readxl.tidyverse.org
- https://datatofish.com/export-dataframe-to-excel-in-r/


#Downloading data

This project is based on two datasets found at Harvard Dataverse's homepage. 

The first dataset is a csv-file, why I used the 'read_csv'-function, and I loaded it into the datafram named 'c19'.
The second dataset is a xlsx-file, why I used the 'read_excel'-function, which is included in the 'readxl'-package. This dataset was loaded into the dataframe named 'spanish_flu'.

The two datasets contain information about the number of deaths due to COVID-19 and the Spanish flu in Punjab, India. 


```{r}
c19 <- read_csv("Data/India_States_summary_covid19_death.csv")
spanish_flu <- read_excel("Data/Mortality.monthly_Punjab.India_1916.1921.xlsx", sheet = 2)
```


Link to datasets:
- https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/28995+
- https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/9QZGZB


#Cleaning the 'c19' data frame

The 'c19'-data frame had to be cleaned because all the different dates formed their own columns together with their respective values.
To clean the spreadsheet the two variables; ‘date’ and ‘deaths’ had to form their own two columns containing the values; date and number of deaths. 
I started by extracting the columns 3-163, which I had to use for the ‘pivot_longer’-function and placed them into the value ‘dates’. 
The reason why I did not include column 1 and 2 was because they agreed to the criteria of tidy data. 


```{r}
dates <- colnames(c19)[3:163]
```


Subsequently, I used the ‘pivot_longer’-function, to make the data frame ‘longer’ by increasing the number of rows and decreasing the number of columns, and thereby creating two new columns called 'date' and deaths'. 
I also used the ‘filter’-function on the column named ‘States’ because I was only interested in the numbers from Punjab. 
Finally, I used the 'mutate'-function to modify the values in the column named 'date' in order for RStudio to recognize them as dates (yyyy-mm-dd). The 'lubridate'-package makes it easier to work with dates, and included the 'ymd'-function. 


```{r}
c19 %>% 
  pivot_longer(all_of(dates), names_to = "date", values_to = "deaths") %>% 
  filter(States == "Punjab") %>% 
  mutate(date = ymd(date)) -> c19
```


I used the 'write_xlsx'-function to save the cleaned 'c19' dataframe as a xlsx-file on my Desktop in the folder called 'Final project' under 'Data'.


```{r}
write_xlsx(c19,"C:\\Users\\Mette\\Desktop\\Final project\\Data\\covid_19_clean.xlsx")
```


Link to functions used:
- https://r4ds.had.co.nz/tidy-data.html#pivoting
- https://r4ds.had.co.nz/dates-and-times.html#dates-and-times
- https://datatofish.com/export-dataframe-to-excel-in-r/


#Visualizations

This project includes two visualizations based on data from the loaded datasets. 
For this i used the 'ggplot'-function, which makes it easy to make plots based on data stored in a data frame. 
I also used the 'geom_point'-function, which specifies that the plot should consist of scatterplots. 
Aes is short for aesthetics and is a function used to specify how the variables should be presented in the graph as x/y positions.


The first graph shows the daily amounts of deaths from March to August 2020 due to COVID-19 in Punjab, India. 


```{r}
c19 %>% 
  ggplot() +
  geom_point(mapping = aes(x = date, y = deaths))
```


The second graph shows the number of deaths per month due to fever in the districts of Punjab, India from 1916-1921. 


```{r}
spanish_flu %>% 
  ggplot() +
  geom_point(mapping = aes(x = Date, y = Mortality))
```

Link to functions used:
- https://datacarpentry.org/r-socialsci/04-ggplot2/index.html